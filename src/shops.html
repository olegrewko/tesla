<!DOCTYPE html>
<html lang="ru" class="page">

@include('partials/head.html')

<body class="page__body">

  <div class="site-container">
    <div class="overlay"></div>
    @include('partials/header-inner.html')
    <main class="main">
      <!-- <div style="height: 3000px;"></div> -->
      @include('partials/breadcrumbs-shops.html')
      @include('partials/shops-content.html')

    </main>
    @include('partials/popup.html')
    @include('partials/modal.html')
    @include('partials/footer.html')
    <style>
      /* #map {
        width: 100%;
        height: 400px;
        margin: 10px 0;
        border: 1px solid #ccc;
        border-radius: 8px;
        background: #0066ff;
      } */

      .controls {
        margin: 20px 0;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .map-btn {
        padding: 10px 20px;
        background: #0066ff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: background 0.3s;
      }

      .map-btn:hover {
        background: #0052cc;
      }

      .map-btn.active {
        background: #003d99;
      }

      .info {
        margin-top: 20px;
        padding: 15px;
        background: #f5f5f5;
        border-radius: 4px;
      }
    </style>
    <!-- <script src="https://api-maps.yandex.ru/2.1/?apikey=YOUR_API_KEY&lang=ru_RU"></script> -->
    <!-- <script src="https://api-maps.yandex.ru/2.1/?apikey=ваш_ключ_API&lang=ru_RU"></script> -->
    <!-- @include('html/h1.html') пример include -->
    <!-- <script>
      // Весь код в одном теге script
      ymaps.ready(init);

      function init() {
        // Создаем ОДНУ карту
        var myMap = new ymaps.Map("map", {
          center: [55.76, 37.64],
          zoom: 10,
          controls: ['zoomControl', 'fullscreenControl']
        });

        // Добавляем метку
        var myPlacemark = new ymaps.Placemark([55.76, 37.64], {
          hintContent: 'Москва',
          balloonContent: 'Столица России'
        }, {
          preset: 'islands#redIcon'
        });

        myMap.geoObjects.add(myPlacemark);

        // Обработчики для кнопок
        var buttons = document.querySelectorAll('.map-btn');

        buttons.forEach(function (button) {
          button.addEventListener('click', function () {
            var type = this.getAttribute('data-type');

            // Меняем тип карты
            myMap.setType('yandex#' + type);

            // Обновляем активную кнопку
            buttons.forEach(function (btn) {
              btn.classList.remove('active');
            });
            this.classList.add('active');
          });
        });
      }
      // Инициализация карты
      // ymaps.ready(init);

      // function init() {
      //   // Создаем карту
      //   var myMap = new ymaps.Map("map", {
      //     center: [55.76, 37.64],
      //     zoom: 10,
      //     controls: ['zoomControl', 'fullscreenControl', 'typeSelector', 'rulerControl']
      //   });

      //   // Добавляем метку
      //   var myPlacemark = new ymaps.Placemark([55.76, 37.64], {
      //     hintContent: 'Москва, Кремль',
      //     balloonContent: '<strong>Москва</strong><br>Столица России<br><img src="https://via.placeholder.com/200x100" width="200" height="100">'
      //   }, {
      //     preset: 'islands#redIcon',
      //     iconColor: '#ff0000'
      //   });

      // myMap.geoObjects.add(myPlacemark);

      // // Получаем элементы управления
      // var buttons = document.querySelectorAll('.map-btn');
      // var currentTypeSpan = document.getElementById('current-type');
      // var currentZoomSpan = document.getElementById('current-zoom');
      // var currentCenterSpan = document.getElementById('current-center');

      // // Добавляем обработчики для кнопок
      // buttons.forEach(function (button) {
      //   button.addEventListener('click', function () {
      //     var type = this.getAttribute('data-type');

      //     // Меняем тип карты
      //     myMap.setType('yandex#' + type);

      //     // Обновляем активную кнопку
      //     buttons.forEach(function (btn) {
      //       btn.classList.remove('active');
      //     });
      //     this.classList.add('active');

      //     // Обновляем информацию о типе карты
      //     var typeNames = {
      //       'map': 'Схема',
      //       'satellite': 'Спутник',
      //       'hybrid': 'Гибрид',
      //       'vector#publicMap': 'Народная',
      //       'vector#publicMapHybrid': 'Народная+спутник'
      //     };
      //     currentTypeSpan.textContent = typeNames[type];
      //   });
      // });

      // // Обновляем информацию при изменении масштаба
      // myMap.events.add('boundschange', function (event) {
      //   currentZoomSpan.textContent = event.get('newZoom');
      //   var center = event.get('newCenter');
      //   currentCenterSpan.textContent = center[0].toFixed(4) + ', ' + center[1].toFixed(4);
      // });

      // // Добавляем несколько меток
      // var additionalPlaces = [
      //   {
      //     coords: [55.751, 37.618],
      //     name: 'Красная площадь',
      //     description: 'Главная площадь Москвы'
      //   },
      //   {
      //     coords: [55.709, 37.603],
      //     name: 'Парк Горького',
      //     description: 'Центральный парк культуры и отдыха'
      //   },
      //   {
      //     coords: [55.715, 37.553],
      //     name: 'МГУ',
      //     description: 'Московский государственный университет'
      //   }
      // ];

      // additionalPlaces.forEach(function (place) {
      //   var placemark = new ymaps.Placemark(place.coords, {
      //     hintContent: place.name,
      //     balloonContent: place.description
      //   }, {
      //     preset: 'islands#blueIcon'
      //   });

      //   myMap.geoObjects.add(placemark);
      // });

      // // Поиск по карте
      // var searchControl = new ymaps.control.SearchControl({
      //   options: {
      //     provider: 'yandex#search',
      //     noPlacemark: false
      //   }
      // });

      // myMap.controls.add(searchControl);

      // // Координаты при клике
      // myMap.events.add('click', function (event) {
      //   var coords = event.get('coords');

      //   // Если клик по карте (не по метке)
      //   if (!event.get('target').properties) {
      //     var clickPlacemark = new ymaps.Placemark(coords, {
      //       balloonContent: 'Вы кликнули по координатам: ' + coords
      //     }, {
      //       preset: 'islands#greenIcon'
      //     });

      //     myMap.geoObjects.add(clickPlacemark);

      //     // Удаляем старую метку через 5 секунд
      //     setTimeout(function () {
      //       myMap.geoObjects.remove(clickPlacemark);
      //     }, 5000);
      //   }
      // });
      // }
    </script> -->
  </div>
  <script defer src="js/main.js"></script>
  <script>
    // import vars from "./js/_vars.js";

    document.addEventListener('DOMContentLoaded', function () {
      // Проверяем, что переменная существует
      if (!vars || !vars.catalogFilterBlocks) {
        console.error('vars.catalogFilterBlocks не определена!');
        return;
      }

      console.log('Блоков найдено:', vars.catalogFilterBlocks.length);

      if (vars.catalogFilterBlocks.length) {
        vars.catalogFilterBlocks.forEach((block, index) => {
          const btn = block.querySelector(".catalog-filter__btn");
          const inner = block.querySelector(".catalog-filter__inner");

          // Проверяем, что элементы внутри блока найдены
          if (!btn) {
            console.error(`Не найдена кнопка в блоке ${index}`);
            return;
          }

          if (!inner) {
            console.error(`Не найден inner в блоке ${index}`);
            return;
          }

          console.log(`Настройка блока ${index}:`, { btn, inner });

          btn.addEventListener('click', (e) => {
            console.log(`Клик по блоку ${index}`);

            // Переключаем класс
            block.classList.toggle('catalog-filter__block--open');
            const isOpen = block.classList.contains('catalog-filter__block--open');

            console.log(`Состояние: ${isOpen ? 'открыт' : 'закрыт'}`);

            // Устанавливаем ARIA атрибуты
            btn.setAttribute("aria-expanded", isOpen);
            btn.setAttribute('aria-label', isOpen ? "Закрыть блок" : "Открыть блок");

            // Анимация высоты
            if (isOpen) {
              inner.style.maxHeight = `${inner.scrollHeight}px`;
              // Добавляем transition для плавности
              inner.style.transition = 'max-height 0.3s ease';
            } else {
              inner.style.maxHeight = null;
            }
          });

          // Добавляем обработчик клавиатуры для доступности
          btn.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              btn.click();
            }
          });
        });
      } else {
        console.warn('Блоки фильтра не найдены на странице');
      }
    });

  </script>
  <!-- Инициализируем ПОСЛЕ загрузки DOM -->
  <!-- <script>
    const priceRange = document.querySelector('.price-range');

    if (priceRange) {
      console.log('Элемент найден, создаю слайдер...');

      noUiSlider.create(priceRange, {
        start: [0, 50000],
        connect: true,
        range: {
          'min': 0,
          'max': 50000
        },
        step: 1000, // Шаг для удобства
        tooltips: true, // Показать значения
        format: {
          to: function (value) {
            return Math.round(value).toLocaleString('ru-RU') + ' ₽';
          },
          from: function (value) {
            return Number(value.replace(/\s/g, '').replace('₽', ''));
          }
        }
      });

      // Для отладки: красим слайдер
      priceRange.style.backgroundColor = '#f0f0f0';
      priceRange.style.padding = '20px';
      priceRange.style.borderRadius = '8px';

    } else {
      console.error('Элемент .price-range не найден!');
    }
  </script> -->
  <!-- Добавьте в <head> или перед </body> -->
<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&apikey=ваш_ключ_api" type="text/javascript"></script>
</body>

</html>
